<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="MenuDao">

	<resultMap type="MenuVO" id="MenuMap">
	
		<id column="MENU_NO" property="menu_number" />
		<result column="MENU_DT" property="menu_date" />
		<result column="MENU_KIND" property="menu_kind" />
		<result column="MENU_FILE_NAME" property="menu_file_name" />
		
		<association property="foodSetVO" javaType="FoodSetVO">
		
			<association property="foodVO" javaType="FoodVO">
				
				<id column="FOOD_NO" property="food_no" />
				<result column="FOOD_NAME" property="food_name" />
				<result column="FOOD_CALORY" property="food_calory" />
				<result column="FOOD_KIND" property="food_kind" />
				
			</association>
			
		</association>
		
	</resultMap>
	
	<select id="selectById" parameterType="string" resultMap="MenuMap">
		SELECT MENU_NO, MENU_DT, MENU_KIND, MENU_FILE_NAME
		FROM MENU
		WHERE MENU_NO = #{menu_number}
	</select>


	<select id="getOneWeekMenu" parameterType="_int" resultMap="MenuMap">
		SELECT	M.MENU_NO
				, 	M.MENU_DT
				,	M.MENU_KIND
				,	F.FOOD_NAME
		FROM 	FOOD_SET FS
				, 	MENU M
				,	FOOD F
		WHERE	M.MENU_NO = FS.MENU_NO
		AND		FS.FOOD_NO = F.FOOD_NO
		AND		M.MENU_KIND = #{menu_kind}
		AND		MENU_DT >= ADDDATE( CURDATE(), - WEEKDAY(CURDATE()) + 0 ) 
		AND		MENU_DT <![CDATA[<= ]]> ADDDATE( CURDATE(), - WEEKDAY(CURDATE()) + 4 ) 
		ORDER 	BY MENU_DT
				, M.MENU_NO

	</select> 

 	<select id="selectByIdAndMonth" parameterType="hashmap" resultMap="MenuMap">

	</select> 

</mapper>